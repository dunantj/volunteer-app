{% extends "base.html" %}

{% block content %}
<h2>Match Volunteering</h2>

<!-- Filter by Home Team -->
<form method="get" class="mb-3">
    <label for="team">Filter by Home Team:</label>
    <select name="team" id="team" onchange="this.form.submit()">
        <option value="">All Teams</option>
        {% for t in teams %}
            <option value="{{ t }}" {% if t == selected_team %}selected{% endif %}>{{ t }}</option>
        {% endfor %}
    </select>
</form>

<!-- Match list -->
{% for item in match_data %}
<div class="match-card" style="padding:15px; border:1px solid #ccc; border-radius:8px; margin-bottom:15px; background:#fafafa;">
    <strong>{{ item.match.date }} {{ item.match.start_time }}:</strong>
    {{ item.match.home_team }} vs {{ item.match.guest_team }} ({{ item.match.location }})
    <br>
    <strong>Volunteers ({{ item.match.volunteer_count }}/3):</strong>
    <div style="display:flex; gap:10px; margin-top:5px; flex-wrap: wrap;">
        {% for slot in item.match.slots.all %}
        <div style="padding:5px 10px; border:1px solid #ccc; border-radius:5px; min-width:80px; text-align:center; background:#f7f7f7;">
            {% if slot.volunteer %}
                âœ… {{ slot.volunteer.username }}
            {% else %}
                &nbsp; <!-- empty slot -->
            {% endif %}
        </div>
        {% endfor %}
    </div>

    {% if item.can_volunteer and item.open_slot and not item.user_signed_up %}
    <a href="{% url 'signup_slot' item.match.id item.open_slot.id %}" 
       style="display:inline-block; margin-top:10px; padding:8px 15px; background:#2c3e50; color:#fff; border-radius:5px; text-decoration:none; font-weight:bold;">
       Volunteer for this match
    </a>
    {% elif item.user_signed_up %}
    <span style="display:inline-block; margin-top:10px; padding:8px 15px; background:#27ae60; color:#fff; border-radius:5px;">You're signed up!</span>
    {% endif %}
</div>
{% endfor %}

{% if not match_data %}
<p>No matches available for volunteering at the moment.</p>
{% endif %}

{% endblock %}
